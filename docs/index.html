<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <title>受付デモ（フロントのみ）</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>
  <h1>受付画面（モック）</h1>

  <label>携帯番号（09012345678 形式）：
    <input id="phone" placeholder="09012345678">
  </label>

  <label>名前（空欄で匿名）：
    <input id="name">
  </label>

  <button onclick="take()">順番を取る</button>

  <p id="ticket"></p>
  <p id="remain"></p>

  <script>
    /* 待ち行列をブラウザ内だけで保持 */
    let queue = JSON.parse(localStorage.getItem('queue') || '[]');
    let myNo  = null;

    /* 保存ヘルパー */
    function save() {
      localStorage.setItem('queue', JSON.stringify(queue));
    }

    /* 1. 順番を取る */
    function take() {
      const name  = document.getElementById('name').value || '匿名';
      const phone = document.getElementById('phone').value;
      const no    = queue.length ? queue[queue.length - 1].no + 1 : 1;
      queue.push({ no, name, phone });
      save();

      myNo = no;
      document.getElementById('ticket').textContent =
        `あなたの番号：${no}（${name}）`;
      refreshRemain();
    }

    /* 2. 残り組数を計算 */
    function refreshRemain() {
      if (myNo === null) return;
      const ahead = queue.filter(t => t.no < myNo).length;
      document.getElementById('remain').textContent =
        `あと ${ahead} 組お待ちください`;
    }

    /* ページ読み込み時に初期化 */
    setInterval(refreshRemain, 5000);  // 5 秒ごとに更新
  </script>
</body>
</html>
